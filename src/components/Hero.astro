---
import { Copy, Github, ChevronDown, Zap } from '@lucide/astro';
import ReleaseBadge from "./ReleaseBadge.astro"
import MacOS from "./os/MacOS.astro"
import Linux from "./os/Linux.astro"
import Windows from "./os/Windows.astro"
---
<section class="min-h-screen py-28 px-4">
  <div class="container mx-auto text-center max-w-4xl mt-6">

    <ReleaseBadge/>

    <h1 class="text-5xl font-semibold my-6 leading-tight">
      Private Search 
      <span class="text-gray-500">Multiplexer</span>
    </h1>

    <p class="text-lg md:text-xl text-gray-600 mb-8 max-w-2xl mx-auto leading-relaxed">
      Supercharge your browser with zero friction.
    </p>

    <div
      id="curlCommandBlock"
      class="hidden md:block group bg-gray-100 rounded-lg p-4 max-w-lg mx-auto font-mono text-sm transition-all
             hover:shadow-sm active:shadow-md cursor-pointer relative overflow-x-auto whitespace-nowrap active:-translate-y-1"
    >
      curl -fsSL https://michi.run/install.sh | sh
      <span
        id="copyFeedback"
        class="absolute bottom-1/2 translate-y-1/2 right-2 text-xs text-green-600 opacity-0 transition-opacity duration-300"
      />
      <Copy
        stroke-width={1}
        class="group-hover:opacity-60 group-active:opacity-100 absolute bottom-1/2 translate-y-1/2 left-4 opacity-30 transition-opacity"
      />
    </div>

    <div class="hidden md:flex justify-center items-center gap-8 mt-4 opacity-90">

      <!-- Linux -->
      <div class="flex items-center gap-2">
        <Linux class="h-7 w-7" />
        <span class="text-sm font-medium text-gray-700">Linux</span>
      </div>

      <!-- macOS (coming soon) -->
      <div class="flex items-center gap-2 opacity-50 cursor-not-allowed">
        <MacOS class="h-7 w-7" />
        <span class="text-sm font-medium text-gray-500">macOS (soon)</span>
      </div>

      <!-- WSL2 -->
      <div class="flex items-center gap-2">
        <Windows class="h-7 w-7" />
        <span class="text-sm font-medium text-gray-700">WSL2</span>
      </div>

    </div>


    <div class="md:hidden flex justify-center">
      <span
        class="inline-flex items-center gap-2 px-4 py-1.5 rounded-full bg-yellow-50 border border-yellow-400 
               text-sm font-medium text-yellow-700"
      >
        <Zap size={18} stroke-width={1}/> Blazingly fast
      </span>
    </div>

    <a
      href="#about"
      class="flex animate-bounce justify-center items-center mt-40 text-gray-700 hover:text-gray-900 transition"
    >
      <ChevronDown stroke-width={1} size={50} />
    </a>

  </div>
</section>

<script is:inline>
  const curlCommandBlock = document.getElementById('curlCommandBlock');
  const copyFeedback = document.getElementById('copyFeedback');
  const commandToCopy = "curl -fsSL https://michi.run/install.sh | sh";

  if (curlCommandBlock) {
    curlCommandBlock.addEventListener('click', async () => {
      let success = false;
      try {
        if (navigator.clipboard && navigator.clipboard.writeText) {
          await navigator.clipboard.writeText(commandToCopy);
          success = true;
        }       
      } catch (err) {
        console.error('Failed to copy text:', err);
        success = false;
      }

      if (copyFeedback) {
        if (success) {
          copyFeedback.textContent = 'Copied!';
          copyFeedback.classList.remove('text-red-600');
          copyFeedback.classList.add('text-green-600');
        } else {
          copyFeedback.textContent = 'Failed to copy!';
          copyFeedback.classList.remove('text-green-600');
          copyFeedback.classList.add('text-red-600');
        }
        copyFeedback.classList.add('opacity-100'); 

        setTimeout(() => {
          copyFeedback.classList.remove('opacity-100'); 
          setTimeout(() => { copyFeedback.textContent = ''; }, 300);
        }, 2000);
      }
    });
  }
</script>
